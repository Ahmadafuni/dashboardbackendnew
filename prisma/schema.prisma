datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  // directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum CategoryName {
  MANAGEMENT
  PRODUCTION
  SERVICES
}

enum Priority {
  LOW
  MEDIUM
  HIGH
}

enum Status {
  PENDING
  APPROVED
  REJECTED
  FULFILLED
  CANCELLED
  COMPLETED
  ONGOING
}

enum MainStatus {
  AWAITING
  TODO
  INPROGRESS
  DONE
  CHECKING
}

enum MovementType {
  INCOMING
  OUTGOING
  TRANSFER
  RETURN
}

enum TemplateSizeType {
  CUTTING
  DRESSUP
}

enum DepartmentCategory {
  CUTTING
  DRAWING
  ENGINEERING
  FACTORYMANAGER
  PRINTING
  QUALITYASSURANCE
  TAILORING
  WAREHOUSEMANAGER
}

enum Season {
  SUMMER
  FALL
  WINTER
  SPRING
}

enum NoteType {
  GENERAL
  REMINDER
  ATTENTION
}

model AuditRecords {
  Id                          Int                          @id @default(autoincrement())
  CreatedAt                   DateTime                     @default(now())
  UpdatedAt                   DateTime                     @updatedAt
  CreatedById                 Int?
  UpdatedById                 Int?
  CreatedBy                   Users?                       @relation(name: "CreatedBy", fields: [CreatedById], references: [Id])
  UpdatedBy                   Users?                       @relation(name: "UpdatedBy", fields: [UpdatedById], references: [Id])
  IsDeleted                   Boolean                      @default(false)
  Colors                      Colors?
  Departments                 Departments?
  InternalOrders              InternalOrders?
  ManufacturingStages         ManufacturingStages?
  MaterialCategories          MaterialCategories?
  MaterialMovements           MaterialMovements?
  Materials                   Materials?
  OrderDetailColors           OrderDetailColors?
  OrderDetails                OrderDetails?
  OrderDetailSizes            OrderDetailSizes?
  OrderDetailTemplateTypes    OrderDetailTemplateTypes?
  Orders                      Orders?
  ProductCatalogCategoryOne   ProductCatalogCategoryOne?
  ProductCatalogCategoryTwo   ProductCatalogCategoryTwo?
  ProductCatalogDetails       ProductCatalogDetails?
  ProductCatalogs             ProductCatalogs?
  ProductCatalogTextiles      ProductCatalogTextiles?
  Sizes                       Sizes?
  Suppliers                   Suppliers?
  TemplatePatterns            TemplatePatterns?
  Templates                   Templates?
  TemplateSizes               TemplateSizes?
  TemplateTypes               TemplateTypes?
  Users                       Users?
  Warehouses                  Warehouses?
  Tasks                       Tasks?
  Measurements                Measurements?
  Models                      Models?
  Collections                 Collections?
  ModelVarients               ModelVarients?
  Notes                       Notes?
  TrakingModels               TrakingModels?
  TrackingModelStageDurations TrackingModelStageDurations?
}

model Collections {
  Id             Int          @id @default(autoincrement())
  CollectionName String       @db.VarChar(255)
  Description    String?
  Audit          AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId        Int          @unique
  Orders         Orders[]
}

model Colors {
  Id                Int                 @id @default(autoincrement())
  ColorName         String              @db.VarChar(50)
  ColorCode         String              @db.VarChar(10)
  Description       String
  Audit             AuditRecords        @relation(fields: [AuditId], references: [Id])
  AuditId           Int                 @unique
  OrderDetailColors OrderDetailColors[]
  ModelVarients     ModelVarients[]
}

model Departments {
  Id                    Int                   @id @default(autoincrement())
  Name                  String                @unique @db.VarChar(255)
  NameShort             String                @unique @db.VarChar(255)
  Location              String?               @db.VarChar(255)
  Description           String?
  Category              DepartmentCategory
  Audit                 AuditRecords          @relation(fields: [AuditId], references: [Id])
  AuditId               Int                   @unique
  AssignedTasks         Tasks[]               @relation(name: "AssignedTo")
  CreatedTasks          Tasks[]               @relation(name: "CreatedBy")
  InternalOrders        InternalOrders[]
  FromMaterialMovements MaterialMovements[]   @relation(name: "FromDepartment")
  ToMateralMovements    MaterialMovements[]   @relation(name: "ToDepartment")
  ManufacturingStages   ManufacturingStages[]
  Users                 Users[]
  AssignedDepartment    Notes[]               @relation("AssignedDepartment")
  CreatedDepartment     Notes[]               @relation("CreatedDepartment")
  Notifications         Notifications[]
}

model InternalOrders {
  Id                   Int                 @id @default(autoincrement())
  ApprovedAt           DateTime?
  ApprovedBy           Users               @relation(fields: [ApprovedById], references: [Id])
  ApprovedById         Int
  Department           Departments         @relation(fields: [DepartmentId], references: [Id])
  DepartmentId         Int
  OrderDate            DateTime            @default(now())
  ExpectedDeliveryDate DateTime?
  Priority             Priority            @default(LOW)
  Status               Status              @default(PENDING)
  Material             Materials           @relation(fields: [MaterialId], references: [Id])
  MaterialId           Int
  Quantity             Decimal             @db.Decimal(10, 2)
  Specifics            String?
  Notes                String?
  Audit                AuditRecords        @relation(fields: [AuditId], references: [Id])
  AuditId              Int                 @unique
  MaterialMovements    MaterialMovements[]
}

model ManufacturingStages {
  Id                          Int                           @id @default(autoincrement())
  StageNumber                 Int
  StageName                   String                        @db.VarChar(255)
  WorkDescription             String?
  Duration                    Int
  Template                    Templates                     @relation(fields: [TemplateId], references: [Id])
  TemplateId                  Int
  Department                  Departments                   @relation(fields: [DepartmentId], references: [Id])
  DepartmentId                Int
  Audit                       AuditRecords                  @relation(fields: [AuditId], references: [Id])
  AuditId                     Int                           @unique
  TrackingModelStageDurations TrackingModelStageDurations[]
  CurrentTrakingModels        TrakingModels[]               @relation("CurrentStage")
  NextTrakingModels           TrakingModels[]               @relation("NextStage")
}

model MaterialCategories {
  Id           Int          @id @default(autoincrement())
  CategoryName String       @db.VarChar(255)
  Description  String?
  Audit        AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId      Int          @unique
  Materials    Materials[]
}

model MaterialMovements {
  Id               Int            @id @default(autoincrement())
  CompletedAt      DateTime?
  InternalOrder    InternalOrders @relation(fields: [InternalOrderId], references: [Id])
  InternalOrderId  Int
  Material         Materials      @relation(fields: [MaterialId], references: [Id])
  MaterialId       Int
  FromSupplier     Suppliers?     @relation(name: "FromSupplier", fields: [FromSupplierId], references: [Id])
  FromSupplierId   Int?
  FromDepartment   Departments?   @relation(name: "FromDepartment", fields: [FromDepartmentId], references: [Id])
  FromDepartmentId Int?
  FromWarehouse    Warehouses?    @relation(name: "FromWarehouse", fields: [FromWarehouseId], references: [Id])
  FromWarehouseId  Int?
  ToDepartment     Departments?   @relation(name: "ToDepartment", fields: [ToDepartmentId], references: [Id])
  ToDepartmentId   Int?
  ToWarehouse      Warehouses?    @relation(name: "ToWarehouse", fields: [ToWarehouseId], references: [Id])
  ToWarehouseId    Int?
  ToSupplier       Suppliers?     @relation(name: "ToSupplier", fields: [ToSupplierId], references: [Id])
  ToSupplierId     Int?
  MovementType     MovementType
  Quantity         Decimal        @db.Decimal(10, 2)
  UnitOfMeasure    String         @db.VarChar(10)
  Status           Status         @default(PENDING)
  Notes            String?
  Audit            AuditRecords   @relation(fields: [AuditId], references: [Id])
  AuditId          Int            @unique
}

model Materials {
  Id                Int                 @id @default(autoincrement())
  Name              String              @db.VarChar(255)
  Type              String?             @db.VarChar(255)
  Color             String?             @db.VarChar(45)
  Category          MaterialCategories  @relation(fields: [CategoryId], references: [Id])
  CategoryId        Int
  Supplier          Suppliers           @relation(fields: [SupplierId], references: [Id])
  SupplierId        Int
  Description       String?
  UnitOfMeasure     String?             @db.VarChar(10)
  Quantity          Int
  Audit             AuditRecords        @relation(fields: [AuditId], references: [Id])
  AuditId           Int                 @unique
  InternalOrders    InternalOrders[]
  MaterialMovements MaterialMovements[]
}

model Measurements {
  Id               Int           @id @default(autoincrement())
  TemplateSize     TemplateSizes @relation(fields: [TemplateSizeId], references: [Id])
  TemplateSizeId   Int
  MeasurementName  String        @db.VarChar(255)
  MeasurementValue String        @db.VarChar(255)
  MeasurementUnit  String        @db.VarChar(255)
  Size             Sizes         @relation(fields: [SizeId], references: [Id])
  SizeId           Int
  Audit            AuditRecords  @relation(fields: [AuditId], references: [Id])
  AuditId          Int           @unique
}

model Models {
  Id               Int                       @id @default(autoincrement())
  Order            Orders?                   @relation(fields: [OrderId], references: [Id])
  OrderId          Int?
  OrderNumber      String
  ProductCatalog   ProductCatalogs           @relation(fields: [ProductCatalogId], references: [Id])
  ProductCatalogId Int
  CategoryOne      ProductCatalogCategoryOne @relation(fields: [CategoryOneId], references: [Id])
  CategoryOneId    Int
  categoryTwo      ProductCatalogCategoryTwo @relation(fields: [CategoryTwoId], references: [Id])
  CategoryTwoId    Int
  Textile          ProductCatalogTextiles    @relation(fields: [TextileId], references: [Id])
  TextileId        Int
  Template         Templates                 @relation(fields: [TemplateId], references: [Id])
  TemplateId       Int
  ModelName        String                    @db.VarChar(255)
  ModelNumber      String                    @db.VarChar(255)
  DemoModelNumber  String?                   @db.VarChar(255)
  Characteristics  String?
  Barcode          String?
  LabelType        String?
  PrintName        String?
  PrintLocation    String?
  Description      String?
  Status           MainStatus                @default(AWAITING)
  Images           String?
  Audit            AuditRecords              @relation(fields: [AuditId], references: [Id])
  AuditId          Int                       @unique
  ModelVarients    ModelVarients[]
}

model ModelVarients {
  Id            Int            @id @default(autoincrement())
  Model         Models         @relation(fields: [ModelId], references: [Id])
  ModelId       Int
  Status        MainStatus     @default(AWAITING)
  Color         Colors         @relation(fields: [ColorId], references: [Id])
  ColorId       Int
  Sizes         String
  Quantity      Int
  Audit         AuditRecords   @relation(fields: [AuditId], references: [Id])
  AuditId       Int            @unique
  TrakingModels TrakingModels?
}

model Notes {
  Id                     Int          @id @default(autoincrement())
  NoteType               NoteType     @default(GENERAL)
  CreatedDepartment      Departments? @relation(name: "CreatedDepartment", fields: [CreatedDepartmentId], references: [Id])
  CreatedDepartmentId    Int?
  AssignedToDepartment   Departments? @relation(name: "AssignedDepartment", fields: [AssignedToDepartmentId], references: [Id])
  AssignedToDepartmentId Int?
  Description            String
  Audit                  AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId                Int          @unique
}

model Notifications {
  Id             Int         @id @default(autoincrement())
  Title          String
  Description    String
  URL            String?
  IsSeen         Boolean     @default(false)
  ToDepartment   Departments @relation(fields: [ToDepartmentId], references: [Id])
  ToDepartmentId Int
}

model OrderDetailColors {
  Id            Int          @id @default(autoincrement())
  OrderDetail   OrderDetails @relation(fields: [OrderDetailId], references: [Id])
  OrderDetailId Int
  Color         Colors       @relation(fields: [ColorId], references: [Id])
  ColorId       Int
  Audit         AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId       Int          @unique
}

model OrderDetails {
  Id                      Int                    @id @default(autoincrement())
  QuantityDetails         String?
  productCatalogDetailsId Int
  ProductCatalogDetails   ProductCatalogDetails? @relation(fields: [productCatalogDetailsId], references: [Id])
  ModelQuantity           Int
  Audit                   AuditRecords           @relation(fields: [AuditId], references: [Id])
  AuditId                 Int                    @unique
  OrderDetailColors       OrderDetailColors[]
  OrderDetailSizes        OrderDetailSizes[]
}

model OrderDetailSizes {
  Id            Int          @id @default(autoincrement())
  OrderDetail   OrderDetails @relation(fields: [OrderDetailId], references: [Id])
  OrderDetailId Int
  Size          Sizes        @relation(fields: [SizeId], references: [Id])
  SizeId        Int
  Audit         AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId       Int          @unique
}

model OrderDetailTemplateTypes {
  Id             Int          @id @default(autoincrement())
  OrderDetailId  Int
  TemplateTypeId Int
  Audit          AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId        Int          @unique
}

model Orders {
  Id           Int          @id @default(autoincrement())
  OrderName    String       @db.VarChar(256)
  OrderNumber  String       @unique @db.VarChar(20)
  DeadlineDate DateTime
  Collection   Collections  @relation(fields: [CollectionId], references: [Id])
  CollectionId Int
  Quantity     Int
  Status       Status?      @default(PENDING)
  Description  String?
  FilePath     String?
  Audit        AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId      Int          @unique
  Models       Models[]
}

model ProductCatalogCategoryOne {
  Id                    Int                     @id @default(autoincrement())
  CategoryName          String                  @db.VarChar(255)
  CategoryDescription   String?
  Audit                 AuditRecords            @relation(fields: [AuditId], references: [Id])
  AuditId               Int                     @unique
  ProductCatalogDetails ProductCatalogDetails[]
  Templates             Templates[]
  Models                Models[]
}

model ProductCatalogCategoryTwo {
  Id                    Int                     @id @default(autoincrement())
  CategoryName          String                  @db.VarChar(255)
  CategoryDescription   String?
  Audit                 AuditRecords            @relation(fields: [AuditId], references: [Id])
  AuditId               Int                     @unique
  ProductCatalogDetails ProductCatalogDetails[]
  Templates             Templates[]
  Models                Models[]
}

model ProductCatalogDetails {
  Id                Int                       @id @default(autoincrement())
  ProductCatalog    ProductCatalogs           @relation(fields: [ProductCatalogId], references: [Id])
  ProductCatalogId  Int
  CategoryOne       ProductCatalogCategoryOne @relation(fields: [CategoryOneId], references: [Id])
  CategoryOneId     Int
  CategoryTwo       ProductCatalogCategoryTwo @relation(fields: [CategoryTwoId], references: [Id])
  CategoryTwoId     Int
  Season            Season
  Textile           ProductCatalogTextiles    @relation(fields: [TextileId], references: [Id])
  TextileId         Int
  TemplateType      TemplateTypes             @relation(fields: [TemplateTypeId], references: [Id])
  TemplateTypeId    Int
  TemplatePattern   TemplatePatterns          @relation(fields: [TemplatePatternId], references: [Id])
  TemplatePatternId Int
  StandardWeight    Decimal                   @db.Decimal(10, 2)
  Grammage          Decimal                   @db.Decimal(10, 2)
  Description       String?
  Audit             AuditRecords              @relation(fields: [AuditId], references: [Id])
  AuditId           Int                       @unique
  OrderDetails      OrderDetails[]
}

model ProductCatalogs {
  Id                        Int                     @id @default(autoincrement())
  ProductCatalogName        String                  @db.VarChar(255)
  ProductCatalogDescription String?
  Audit                     AuditRecords            @relation(fields: [AuditId], references: [Id])
  AuditId                   Int                     @unique
  ProductCatalogDetails     ProductCatalogDetails[]
  Templates                 Templates[]
  Models                    Models[]
}

model ProductCatalogTextiles {
  Id                    Int                     @id @default(autoincrement())
  TextileName           String                  @db.VarChar(255)
  TextileType           String                  @db.VarChar(255)
  Composition           String                  @db.VarChar(255)
  Description           String?
  Audit                 AuditRecords            @relation(fields: [AuditId], references: [Id])
  AuditId               Int                     @unique
  ProductCatalogDetails ProductCatalogDetails[]
  Models                Models[]
}

model Sizes {
  Id               Int                @id @default(autoincrement())
  SizeName         String             @db.VarChar(255)
  Description      String?
  Audit            AuditRecords       @relation(fields: [AuditId], references: [Id])
  AuditId          Int                @unique
  OrderDetailSizes OrderDetailSizes[]
  Measurements     Measurements[]
}

model Suppliers {
  Id                    Int                 @id @default(autoincrement())
  Name                  String              @db.VarChar(255)
  Address               String?
  PhoneNumber           String
  email                 String
  Audit                 AuditRecords        @relation(fields: [AuditId], references: [Id])
  AuditId               Int                 @unique
  Materials             Materials[]
  FromMaterialMovements MaterialMovements[] @relation("FromSupplier")
  ToMaterialMovements   MaterialMovements[] @relation("ToSupplier")
}

model Tasks {
  Id                     Int          @id @default(autoincrement())
  TaskName               String       @db.VarChar(255)
  DueAt                  DateTime
  Status                 Status       @default(PENDING)
  Description            String?
  Feedback               String?
  AssignedFile           String?
  FeedbackFile           String?
  AssignedToDepartment   Departments? @relation(name: "AssignedTo", fields: [AssignedToDepartmentId], references: [Id])
  AssignedToDepartmentId Int?
  CreatedByDepartment    Departments? @relation(name: "CreatedBy", fields: [CreatedByDepartmentId], references: [Id])
  CreatedByDepartmentId  Int?
  Audit                  AuditRecords @relation(fields: [AuditId], references: [Id])
  AuditId                Int          @unique
}

model TemplatePatterns {
  Id                    Int                     @id @default(autoincrement())
  TemplatePatternName   String                  @db.VarChar(255)
  Description           String?
  Audit                 AuditRecords            @relation(fields: [AuditId], references: [Id])
  AuditId               Int                     @unique
  ProductCatalogDetails ProductCatalogDetails[]
  Templates             Templates[]
}

model Templates {
  Id                  Int                       @id @default(autoincrement())
  TemplateName        String                    @db.VarChar(255)
  ProductCatalogue    ProductCatalogs           @relation(fields: [ProductCatalogId], references: [Id])
  ProductCatalogId    Int
  CategoryOne         ProductCatalogCategoryOne @relation(fields: [CategoryOneId], references: [Id])
  CategoryOneId       Int
  CategoryTwo         ProductCatalogCategoryTwo @relation(fields: [CategoryTwoId], references: [Id])
  CategoryTwoId       Int
  TemplatePattern     TemplatePatterns          @relation(fields: [TemplatePatternId], references: [Id])
  TemplatePatternId   Int
  TemplateType        TemplateTypes             @relation(fields: [TemplateTypeId], references: [Id])
  TemplateTypeId      Int
  Season              Season
  Description         String?
  FilePath            String?
  Audit               AuditRecords              @relation(fields: [AuditId], references: [Id])
  AuditId             Int                       @unique
  ManufacturingStages ManufacturingStages[]
  TemplateSizes       TemplateSizes[]
  Models              Models[]
}

model TemplateSizes {
  Id               Int               @id @default(autoincrement())
  Name             String            @db.VarChar(255)
  Template         Templates         @relation(fields: [TemplateId], references: [Id])
  TemplateId       Int
  Description      String?
  TemplateSizeType TemplateSizeType?
  Audit            AuditRecords      @relation(fields: [AuditId], references: [Id])
  AuditId          Int               @unique
  Measurements     Measurements[]
}

model TemplateTypes {
  Id                    Int                     @id @default(autoincrement())
  TemplateTypeName      String                  @db.VarChar(255)
  Description           String?
  Audit                 AuditRecords            @relation(fields: [AuditId], references: [Id])
  AuditId               Int                     @unique
  ProductCatalogDetails ProductCatalogDetails[]
  Templates             Templates[]
}

model TrakingModels {
  Id                          Int                           @id @default(autoincrement())
  CurrentStage                ManufacturingStages           @relation("CurrentStage", fields: [CurrentStageId], references: [Id])
  CurrentStageId              Int
  NextStage                   ManufacturingStages?          @relation("NextStage", fields: [NextStageId], references: [Id])
  NextStageId                 Int?
  StartTime                   DateTime?
  EndTime                     DateTime?
  MainStatus                  MainStatus                    @default(AWAITING)
  QuantityReceived            Int?
  QuantityDelivered           Int?
  DamagedItem                 Int?                          @default(0)
  ReplacedItem                Int?                          @default(0)
  Cloth                       String?
  QuantityInKg                String?
  QuantityInNum               Int?
  Notes                       String?
  ModelVariant                ModelVarients                 @relation(fields: [ModelVariantId], references: [Id])
  ModelVariantId              Int                           @unique
  Audit                       AuditRecords                  @relation(fields: [AuditId], references: [Id])
  AuditId                     Int                           @unique
  TrackingModelStageDurations TrackingModelStageDurations[]
}

model TrackingModelStageDurations {
  Id         Int                 @id @default(autoincrement())
  Tracking   TrakingModels       @relation(fields: [TrackingId], references: [Id])
  TrackingId Int
  Stage      ManufacturingStages @relation(fields: [StageId], references: [Id])
  StageId    Int
  StartTime  DateTime            @default(now())
  EndTime    DateTime?
  Audit      AuditRecords        @relation(fields: [AuditId], references: [Id])
  AuditId    Int                 @unique
}

model Users {
  Id             Int              @id @default(autoincrement())
  IsActive       Boolean          @default(false)
  Username       String           @unique @db.VarChar(255)
  Email          String           @unique @db.VarChar(255)
  Firstname      String           @db.VarChar(255)
  Lastname       String           @db.VarChar(255)
  PhotoPath      String?
  PasswordHash   String
  PhoneNumber    String           @unique @db.VarChar(50)
  LastLogin      DateTime?
  Department     Departments?     @relation(fields: [DepartmentId], references: [Id])
  DepartmentId   Int?
  Warehouse      Warehouses?      @relation(fields: [WarehouseId], references: [Id])
  WarehouseId    Int?
  Audit          AuditRecords     @relation(fields: [AuditId], references: [Id])
  AuditId        Int              @unique
  AuditCreatedBy AuditRecords[]   @relation(name: "CreatedBy")
  AuditUpdatedBy AuditRecords[]   @relation(name: "UpdatedBy")
  InternalOrders InternalOrders[]
}

model Warehouses {
  Id                    Int                 @id @default(autoincrement())
  WarehouseName         String              @db.VarChar(255)
  CategoryName          CategoryName?
  Location              String              @db.VarChar(255)
  Capacity              Decimal             @db.Decimal(10, 2)
  Audit                 AuditRecords        @relation(fields: [AuditId], references: [Id])
  AuditId               Int                 @unique
  FromMaterialMovements MaterialMovements[] @relation(name: "FromWarehouse")
  ToMaterialMovements   MaterialMovements[] @relation(name: "ToWarehouse")
  Users                 Users[]
}
